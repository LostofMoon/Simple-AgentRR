# 安卓设备数据收集工具

这是一个用于收集安卓设备UI操作数据的工具，可以记录用户在手机上的点击、滑动、输入等操作，并将数据按应用和任务类型进行分类存储。

## 环境配置
详情查看根目录下的README.md

### 手机配置
- 在Android设备上安装项目根目录中的 `ADBKeyboard.apk` 文件
- 使用USB数据线连接手机和电脑
- 手机上会弹出USB调试授权提示，点击 **允许**

## 快速开始

### 项目启动
在根目录下运行指令
```bash
python -m manual_collection.server
```

启动成功后，访问 http://localhost:9000 查看web界面

## 使用说明

### 数据收集流程

#### 第一步：开始收集
1. 在web界面点击 **开始收集** 按钮

#### 第二步：配置应用信息
2. 在弹出的 **应用信息配置** 窗口中填写：
   - **应用名称**：如 "饿了么"、"微信"、"淘宝" 等
   - **任务类型**：如 “tpye1”、 “tpye2” 等，具体参考收集任务文档

#### 第三步：输入任务描述
3. 在 **任务描述** 窗口中详细描述当前要执行的具体任务

#### 第四步：开始操作
4. 配置完成后，点击“自动刷新”开启自动获取屏幕截图
5. 在web界面的截图上进行操作：
   - **点击**：快速点击截图上的任意位置
   - **滑动**：按住鼠标拖拽到另一个位置松开，注意不要移出整个屏幕范围
   - **文本输入**：点击 **⌨️ 文本输入** 按钮输入文本

#### 第五步：保存数据
5. 完成一个任务后，可以：
   - 点击 **下一条数据** 继续收集同类型任务的更多数据
   - 点击 **结束收集** 结束当前收集会话

#### 放弃任务
当想要放弃这一条数据时可以：
   - 点击 **删除任务** 

### 界面功能说明

#### 主要按钮
- **开始收集**：开始新的数据收集会话
- **结束收集**：保存当前数据并结束收集
- **下一条数据**：保存当前数据并开始收集下一条
- **文本输入**：向设备发送文本内容
- **查看操作历史**：查看当前会话的所有操作记录
- **自动刷新**：自动刷新设备截图（连续模式）

#### 操作类型
1. **点击操作**：快速点击截图上的位置
2. **滑动操作**：支持上下左右四个方向的滑动
3. **文本输入**：通过ADB键盘向设备输入文本

## 数据存储结构

数据存储在/manual_collection/data，按照以下结构：
```
data/
├── <应用名称>/
│   ├── <任务类型>/
│   │   ├── 1/
│   │   │   ├── 1.jpg          # 第1个操作前的截图
│   │   │   ├── 2.jpg          # 第2个操作前的截图
│   │   │   ├── ...
│   │   │   └── actions.json   # 操作记录和任务信息
│   │   ├── 2/
│   │   │   └── ...
│   │   └── ...
│   └── <其他任务类型>/
└── <其他应用名称>/
```

### actions.json 文件格式
```json
{
    "app_name": "饿了么",
    "task_type": "帮我点<店名>的<食品名称>",
    "task_description": "在饿了么APP中点击麦当劳的巨无霸汉堡",
    "action_count": 3,
    "actions": [
        {
            "type": "click",
            "position_x": 500,
            "position_y": 300,
            "bounds": [450, 250, 550, 350]
        },
        {
            "type": "swipe",
            "press_position_x": 500,
            "press_position_y": 800,
            "release_position_x": 500,
            "release_position_y": 400,
            "direction": "up"
        },
        {
            "type": "input",
            "text": "巨无霸"
        },
        {
            "type": "done"
        }
    ]
}
```

## 📄 项目结构

```
├── static/            # 前端静态文件
│   ├── index.html     # 主页面
│   ├── css/           # 样式文件
│   └── js/            # JavaScript文件
├── data/              # 数据存储目录
├── README.md          # 项目说明
└── server.py          # 主应用程序
```